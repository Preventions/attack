<html>
<head>
<title>Obfuscator using Environment variables - by Myo Soe - https://cybersecurity.wtf/ </title>
	<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
<style>
	input[type=text]{width: 100%;height: 20%;font-weight: bold;font-size:2em;}
	textarea{font-weight: bold;font-size:2em;}
	input[type=button]{font-weight: bold;height: 20%;font-size:2em;}
	#dialog{display:hidden;}
	</style>
</head>
<body>
<h1>Obfuscator using Windows Environment variables <a href="https://attack.mitre.org/techniques/T1027/" target="_blank" rel="noopener">#T1027</a></h1>
<h4>by Myo Soe - <a href="https://yehg.net/">YEHG.Net</a></h4>

Original:<br/> <input value="https://cybersecurity.wtf/" type="text" id="original" /><br/><br/>
<input type="button" onclick="update_ob()" value="Shoot"/><br/><br/>

Obfuscated:<br/> <textarea cols="70" rows="5" onclick="copy2clip()" id="obfuscated"></textarea><br/><br/>
<div id="dialog">
	<p> Copied to clipboard!</p>
</div>

<script>
	function copy2clip(){
		var copyTextarea = $("#obfuscated");
		copyTextarea.focus();
		copyTextarea.select();

		try {
			var successful = document.execCommand('copy');
			var msg = successful ? 'successful' : 'unsuccessful';
			$("#dialog").dialog();

		} catch (err) {
			alert('Oops, unable to copy');
		}
	}
	function ob_str(original){
		//windir=C:\Windows
		//allusersprofile=C:\ProgramData
		//ComSpec=C:\Windows\system32\cmd.exe
		//PUBLIC=C:\Users\Public

		original = original.toString().toLowerCase();
		switch(original){

			case "3":
				return  "%comspec:~17,1%";
				break;
			case "2":
				return  "%comspec:~18,1%";
				break;
			case ".":
				return "%comspec:~23,1%";
				break;
			case "a":
				return "%allusersprofile:~9,1%";
			break;
			case "b":
				return "b";
			break;	
			case "c":
				return  "%comspec:~20,1%";
			break;
			case "d":
				return "%comspec:~22,1%"
			break;
			case "e":
				return "%comspec:~24,1%";
			break;
			case "f":
				return "f";
			break;
			case "g":
				return "%allusersprofile:~6,1%";
				break;
			case "h":
				return "h";
				break;
			case "i":
				return "%windir:~4,1%";
				break;
			case "j":
				return "j";
				break;
			case "k":
				return "k";
				break;
			case "l":
				return  "%public:~13,1%";
				break;
			case "m":
				return "%comspec:~21,1%";
				break;
			case "n":
				return "%windir:~5,1%";
				break;
			case "o":
				return "%windir:~7,1%";
				break;
			case "p":
				return "%allusersprofile:~3,1%";
				break;
			case "q":
				return "q";
				break;
			case "r":
				return "%allusersprofile:~4,1%";
				break;
			case "s":
				return "%windir:~9,1%";
				break;
			case "t":
				return "%allusersprofile:~12,1%";
				break;
			case "u":
				return  "%public:~4,1%";
				break;
			case "v":
				return "v";
				break;
			case "w":
				return "%windir:~3,1%";
				break;
			case "x":
				return "%comspec:~25,1%";
				break;
			case "y":
				return  "%comspec:~12,1%";
				break;
			case "z":
				return "z";
				break;
			case ":":
				return "%windir:~1,1%";
				break;
			case "/":
				return "%windir:~2,1%";
				break;
		}		
		return original;
	}
	function update_ob(){
		var o = $("#original").val();
		a = o.split("");
		n = new Array();
		
		for(var x=0;x<=a.length-1;x++){
			ob= a[x];
			console.log(ob);
			nb =ob_str(ob);
			n.push(nb);

		}
		nx = n.join("");
		//nx = nx.replace(/,/g, "");
		$("#obfuscated").val(nx);
	}

</script>
</body>
<html>